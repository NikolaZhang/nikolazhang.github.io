import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,e as n,o as e}from"./app-BqdhXfNE.js";const t="/assets/image-1-8-L2bL8T.png",l="/assets/image-B17m50tq.png",h="/assets/image-2-DjNW3j_J.png",p="/assets/image-3-yIsZLFDP.png",k="/assets/image-4-Datn0CjM.png",r="/assets/image-7-DOxNSjze.png",d="/assets/image-6-DjPW99L4.png",g="/assets/image-5-CJ6qENc9.png",o={};function c(A,i){return e(),a("div",null,[...i[0]||(i[0]=[n(`<blockquote><p>淘汰掉的安卓手机，弃之不用有些可惜。我们可以尝试将其变为一个服务器，用于部署常用的服务。 简单的方式，可以在本地构建，之后通过ssh将jar包传到对应的目录下，之后通过命令启动服务，这种方式自动化太低。</p></blockquote><p>为了能够自动化的构建及部署服务，Jenkins是个不错的选择。这篇文章主要解决，将jenkins部署在安卓手机上，并完成基础的配置。</p><h2 id="安装jenkins" tabindex="-1"><a class="header-anchor" href="#安装jenkins"><span>安装Jenkins</span></a></h2><p>从<a href="https://www.jenkins.io/zh/" target="_blank" rel="noopener noreferrer">Jenkins官网</a>上，可以找到对应的下载页面。这里我们下载最新的war包，通过war包部署，这种方式应该是最可靠的。</p><p>你可以通过命令下载，稳定版2.364.3</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://mirrors.jenkins.io/war-stable/2.346.3/jenkins.war</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="部署jenkins" tabindex="-1"><a class="header-anchor" href="#部署jenkins"><span>部署Jenkins</span></a></h2><p>之后启动Jenkins会创建新的文件，最好提前将下载的war包，移动到一个自定义的目录中。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> app/jenkins</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jenkins.war</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> app/jenkins</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>写一个启动脚本（名字可以为<code>jenkins.sh</code>），如下：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 导入环境变量</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> JENKINS_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">jenkins</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> JAVA_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">lib</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">jvm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">java-21-openjdk-arm64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $JENKINS_HOME</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ef</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jenkins.war </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;grep&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;{print $2}&#39;\`</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;start&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;[</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">]jenkins is running...&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  else</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    ### java启动服务 配置java安装根路径,和启动war包存的根路径</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    nohup</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $JAVA_HOME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/bin/java</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Xms128m</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Xmx512m</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        -jar</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $JENKINS_HOME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/jenkins.war</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        --httpPort=18080</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        --logfile=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$JENKINS_HOME</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">/jenkins.log</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/dev/null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1 &amp;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  fi</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">elif</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;stop&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ef</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jenkins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> grep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;{print $2}&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xargs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kill</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -9</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;jenkins is stop...&#39;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Please input like this:&quot;./jenkins.sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start&quot; or &quot;./jenkins</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">fi</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个脚本中我们通过start参数来启动Jenkins，stop参数用来停止。Jenkins的访问端口为18080。 另外需要注意的是稳定版<code>2.364.3</code>要求java版本为11，17，21。</p><h2 id="启动及访问jenkins" tabindex="-1"><a class="header-anchor" href="#启动及访问jenkins"><span>启动及访问Jenkins</span></a></h2><p>通过<code>./jenkins.sh start</code>命令启动。首次访问需要查看日志（jenkins.log）中打印的token。</p><p>在浏览器中输入<code>http://手机IP:18080/</code>，输入token后，即可访问Jenkins。</p><h2 id="设置用户权限" tabindex="-1"><a class="header-anchor" href="#设置用户权限"><span>设置用户权限</span></a></h2><p>进入<code>系统管理 &gt; 全局安全配置</code>，按照下图进行配置安全域。</p><figure><img src="`+t+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>设置好安全域之后，回到<code>系统管理</code>界面，就可以找到<code>用户管理</code>。在这个页面可以添加用户。</p><figure><img src="'+l+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>如果希望通过角色进行权限管理，在插件管理中搜索<code>Role-based Authorization Strategy</code>。</p><p>打开<code>Manage and Assign Roles</code>。</p><p>进入<code>Manage Roles</code>的界面就可以添加角色了。</p><figure><img src="'+h+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>在<code>Assign Roles</code>页面可以为用户设置角色。</p><figure><img src="'+p+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>最后不要忘了，全局安全配置要设置基于角色的授权策略。</p><figure><img src="'+k+`" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><h2 id="配置" tabindex="-1"><a class="header-anchor" href="#配置"><span>配置</span></a></h2><h3 id="maven配置" tabindex="-1"><a class="header-anchor" href="#maven配置"><span>maven配置</span></a></h3><p>首先下载maven包，并解压。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">https://dlcdn.apache.org/maven/maven-3/3.9.6/binaries/apache-maven-3.9.6-bin.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apache-maven-3.9.6-bin.tar.gz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们的项目通常是maven架构的。Jenkins如果需要支持maven，需要安装插件<code>Maven Integration plugin</code>。</p><p>并在<code>系统管理-全局工具配置</code>中进行如下配置：</p><figure><img src="`+r+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>这里指定了settings.xml的位置。</p><h3 id="gitee配置" tabindex="-1"><a class="header-anchor" href="#gitee配置"><span>gitee配置</span></a></h3><p>如果项目在<code>gitee</code>上，需要安装gitee插件，之后进入<code>系统配置</code>中按照下图进行配置。</p><figure><img src="'+d+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p><code>链接名</code>和<code>Gitee 域名 URL</code>都是固定的。令牌需要到<a href="https://gitee.com/profile/personal_access_tokens" target="_blank" rel="noopener noreferrer">个人令牌</a>页生成，之后添加方式参考下图（ID不重复就行）。</p><figure><img src="'+g+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>最后不要忘了点击保存。</p>',42)])])}const u=s(o,[["render",c]]),F=JSON.parse('{"path":"/posts/android/02-%E5%AE%89%E8%A3%85Jenkins%E5%8F%8A%E9%85%8D%E7%BD%AE.html","title":"【安卓服务器】安装Jenkins及配置","lang":"en-US","frontmatter":{"title":"【安卓服务器】安装Jenkins及配置","tag":["安卓","termux","Jenkins"],"category":"android","description":"安卓手机上安装Jenkins及项目构建","banner":"http://image.nikolazhang.top/wallhaven-nrwq11.jpg","date":"2024-01-09T00:00:00.000Z","author":"nikola","icon":"mobile","isOriginal":true,"sticky":false,"timeline":true,"article":true,"star":false,"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"【安卓服务器】安装Jenkins及配置\\",\\"image\\":[\\"http://image.nikolazhang.top/wallhaven-nrwq11.jpg\\"],\\"datePublished\\":\\"2024-01-09T00:00:00.000Z\\",\\"dateModified\\":\\"2025-12-08T15:31:57.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"nikola\\"}]}"],["meta",{"property":"og:url","content":"https://nikolazhang.github.io/posts/android/02-%E5%AE%89%E8%A3%85Jenkins%E5%8F%8A%E9%85%8D%E7%BD%AE.html"}],["meta",{"property":"og:title","content":"【安卓服务器】安装Jenkins及配置"}],["meta",{"property":"og:description","content":"安卓手机上安装Jenkins及项目构建"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"http://image.nikolazhang.top/wallhaven-nrwq11.jpg"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-12-08T15:31:57.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"http://image.nikolazhang.top/wallhaven-nrwq11.jpg"}],["meta",{"name":"twitter:image:alt","content":"【安卓服务器】安装Jenkins及配置"}],["meta",{"property":"article:author","content":"nikola"}],["meta",{"property":"article:tag","content":"Jenkins"}],["meta",{"property":"article:tag","content":"termux"}],["meta",{"property":"article:tag","content":"安卓"}],["meta",{"property":"article:published_time","content":"2024-01-09T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-08T15:31:57.000Z"}]]},"git":{"createdTime":1704902568000,"updatedTime":1765207917000,"contributors":[{"name":"我小叮当","username":"","email":"nikolazhang@163.com","commits":8}]},"readingTime":{"minutes":3.52,"words":1057},"filePathRelative":"posts/android/02-安装Jenkins及配置.md"}');export{u as comp,F as data};
