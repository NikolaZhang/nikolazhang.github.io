import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as n,o as e}from"./app-Cr8qGYGb.js";const l={};function t(h,i){return e(),a("div",null,[...i[0]||(i[0]=[n(`<blockquote><p>这篇博客主要分享一下自己搭建这个博客中遇到的一些问题和经验。</p></blockquote><h2 id="准备" tabindex="-1"><a class="header-anchor" href="#准备"><span>准备</span></a></h2><p>之前曾使用hexo搭建过一个简易的博客. 这个博客就是在之前的基础上搭建的. 但是不同之处在于这次博客不再依赖于代码仓库(像github,gitee都会支持静态页面之类的部署). gitee部署博客可以通过gitee pages进行. 如下图所示: <img src="http://image.nikolazhang.top/20191229173723.png" alt="gitee部署博客" loading="lazy"><img src="http://image.nikolazhang.top/20191229173845.png" alt="部署详情" loading="lazy"> 但是部署之后域名都会是相关平台的域名. <a href="https://nikolazhang.gitee.io/nikola-blog/" target="_blank" rel="noopener noreferrer">gitee 部署的博客</a><img src="http://image.nikolazhang.top/20191229174157.png" alt="域名" loading="lazy"> 没有灵魂的感觉~当然也可以有其他方法去替换. 这不是重点就不说了.</p><p>这个博客是搭建在阿里云服务器上的. (单核2G89 你值得拥有, 但是不得不吐槽的是2G不够用).</p><h2 id="网站部署" tabindex="-1"><a class="header-anchor" href="#网站部署"><span>网站部署</span></a></h2><h3 id="一键式部署" tabindex="-1"><a class="header-anchor" href="#一键式部署"><span>一键式部署</span></a></h3><p>hexo 支持<a href="https://hexo.io/zh-cn/docs/one-command-deployment" target="_blank" rel="noopener noreferrer">一键式博客部署</a>, 注意一键式部署会将 public 目录中的文件和目录推送至 _config.yml 中指定的远端仓库和分支中，并且完全覆盖该分支下的已有内容。 我的<code>_config.yml</code>配置如下:</p><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yml"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">deploy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">git</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  repo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">git@gitee.com:NikolaZhang/nikola-blog.git</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  branch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">master</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;web updata: {{now(&quot;YYYY-MM-DD HH/mm/ss&quot;)}}&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>博客的静态文件推送到代码库之后, 通过jenkins拉取代码, 将public/目录下的文件全部拷贝到网站的root目录下. 后面的部署过程可以说对于我们是无感的. 我们只要执行以下<code>hexo g -d</code>就完成了 生成--&gt;推送--&gt;发布 整个过程 ( 最全的命令应该是<code>hexo clean &amp;&amp; hexo g -d</code> 先将之前生成的目录清除掉).</p><p>这种方式就带来了一个问题, 如果换个终端就要重新配置一套环境. 虽然安装的东西不多, 但是总觉得有些累赘. 因此我强烈推荐你使用下面的方式.</p><h3 id="另一种部署方式" tabindex="-1"><a class="header-anchor" href="#另一种部署方式"><span>另一种部署方式</span></a></h3><p>这种部署方式, 就是将环境配置到服务器去, 使用git按照正常流程提交代码, 之后的构建过程, 由服务器完成. 构建之后将, public/下文件拷贝. 因此对于终端来说只要有git就可以了.</p><p>无论是哪种部署方式我们都需要jenkins帮助我们完成构建.</p><h2 id="关于静态资源文件" tabindex="-1"><a class="header-anchor" href="#关于静态资源文件"><span>关于静态资源文件</span></a></h2><p>不建议将静态资源放到博客目录中, 可以放到第三方的云存储中. 比如七牛等. 如果你是用vscode进行编辑文章, 建议安装<code>qiniu-upload-image</code>插件, 这个插件可以将截图,本地图片上传到七牛,并将文件的链接返回.</p><figure><img src="http://image.nikolazhang.top/res.gif" alt="res" tabindex="0" loading="lazy"><figcaption>res</figcaption></figure><h2 id="关于博客的目录与文件介绍" tabindex="-1"><a class="header-anchor" href="#关于博客的目录与文件介绍"><span>关于博客的目录与文件介绍</span></a></h2><p>主要介绍一下经常操作的目录与文件</p><ol><li>_config.yml 博客的基本信息配置 具体配置信息为:可以参考<code>https://hexo.io/zh-cn/docs/configuration</code></li><li>public/ 这个目录上面已经提到了是生成的最终的网页. 所有变动都会被覆盖, 因此不进行操作.</li><li>scaffolds是博客脚手架文件夹 配置了生成一个博客文章的模板</li><li>source是博客的源文件, 该目录下也主要用来放置我们的markdown格式的文章.</li><li>themes 下放置<a href="https://hexo.io/zh-cn/docs/themes" target="_blank" rel="noopener noreferrer">主题</a>文件</li><li>主题中的_config.yml用来配置该主题的样式</li><li>主题中的layout是构建博客主题的具体逻辑, 如果有什么配置不清楚基本可以在这里找到对应的代码, 大概就知道该怎么配置markdown或者yml了.</li></ol><p>总的来说, 我们最常操作的无非就是我们的博客文件(.md)还有配置文件(.yml)</p><h2 id="使用域名及访问" tabindex="-1"><a class="header-anchor" href="#使用域名及访问"><span>使用域名及访问</span></a></h2><p>域名可以在阿里云上申请, 注意申请之后要进行备案. 我也是最近刚进行备案, 时长大概有13-20天, 只有备案之后才可使用80端口进行访问. 因此目前我使用nginx配置了81端口进行访问博客. 我的nginx配置如下:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    listen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          81</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    server_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     blog.nikolazhang.top</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        /home/nikola/app/blog/nikola-blog/public</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       index.html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        try_files</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $uri</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $uri</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /index.html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   Host</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">             $host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   X-Real-IP</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        $remote_addr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   X-Forwarded-For</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  $proxy_add_x_forwarded_for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   X-Forwarded-Proto</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  $scheme</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="jenkins配置" tabindex="-1"><a class="header-anchor" href="#jenkins配置"><span>jenkins配置</span></a></h2><p>再介绍一下jenkins的配置方式:</p><ol><li>首先要指定代码库位置: <img src="http://image.nikolazhang.top/20191229200856.png" alt="配置git" loading="lazy"></li><li>使用钩子作为构建触发器 <img src="http://image.nikolazhang.top/20191229201112.png" alt="触发器" loading="lazy"></li><li>构建的脚本, 主要就是在服务器上进行博客的生成和目录迁移.</li></ol><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/jenkins/workspace/nikola-blog</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cnpm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/jenkins/workspace/nikola-blog/themes/sakura</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cnpm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/jenkins/workspace/nikola-blog</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hexo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hexo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> g</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home/nikola/app/blog/public</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home/nikola/app/blog/public</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/jenkins/workspace/nikola-blog/public</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home/nikola/app/blog/nikola-blog/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="bug及注意事项" tabindex="-1"><a class="header-anchor" href="#bug及注意事项"><span>bug及注意事项</span></a></h2><ul><li>根目录下_config.yml中的relative_link要设置为false. 否则分页会出现问题.</li><li>clone项目到本地之后, 根目录和主题目录下都要执行npm install命令. 否则生成的index.html中将没有内容.</li></ul><h2 id="致谢" tabindex="-1"><a class="header-anchor" href="#致谢"><span>致谢</span></a></h2><p>最后致敬Mashiro和honjun的付出和开源精神. Thank you ~</p>`,31)])])}const r=s(l,[["render",t]]),d=JSON.parse('{"path":"/posts/blog/01-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8F%8A%E9%83%A8%E7%BD%B2.html","title":"博客搭建及部署","lang":"en-US","frontmatter":{"title":"博客搭建及部署","isOriginal":true,"tag":["hexo","nginx","jenkins"],"category":"blog","description":"简单介绍搭建一个博客的过程","date":"2019-12-29T00:00:00.000Z","icon":"book","sticky":false,"timeline":true,"article":true,"star":false,"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"博客搭建及部署\\",\\"image\\":[\\"http://image.nikolazhang.top/20191229173723.png\\",\\"http://image.nikolazhang.top/20191229173845.png\\",\\"http://image.nikolazhang.top/20191229174157.png\\",\\"http://image.nikolazhang.top/res.gif\\",\\"http://image.nikolazhang.top/20191229200856.png\\",\\"http://image.nikolazhang.top/20191229201112.png\\"],\\"datePublished\\":\\"2019-12-29T00:00:00.000Z\\",\\"dateModified\\":\\"2025-12-07T16:26:37.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"DewyYr、\\",\\"url\\":\\"https://blog.nikolazh.eu.org\\"}]}"],["meta",{"property":"og:url","content":"https://blog.nikolazh.eu.org/posts/blog/01-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8F%8A%E9%83%A8%E7%BD%B2.html"}],["meta",{"property":"og:title","content":"博客搭建及部署"}],["meta",{"property":"og:description","content":"简单介绍搭建一个博客的过程"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"http://image.nikolazhang.top/20191229173723.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-12-07T16:26:37.000Z"}],["meta",{"property":"article:tag","content":"jenkins"}],["meta",{"property":"article:tag","content":"nginx"}],["meta",{"property":"article:tag","content":"hexo"}],["meta",{"property":"article:published_time","content":"2019-12-29T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-07T16:26:37.000Z"}]]},"git":{"createdTime":1665625617000,"updatedTime":1765124797000,"contributors":[{"name":"zhangxu","username":"zhangxu","email":"nikolazhang@163.com","commits":5,"url":"https://github.com/zhangxu"},{"name":"nikola","username":"nikola","email":"nikolazhang@163.com","commits":2,"url":"https://github.com/nikola"},{"name":"我小叮当","username":"","email":"nikolazhang@163.com","commits":3}]},"readingTime":{"minutes":4.47,"words":1341},"filePathRelative":"posts/blog/01-博客搭建及部署.md"}');export{r as comp,d as data};
